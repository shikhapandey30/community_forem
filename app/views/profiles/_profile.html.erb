<%= form_for current_user, url: profile_path(current_user), :html => { :multipart => true, :remote => true, class: "profile_form" } do |f| %>
  <%=f.fields_for :profile do |p|%>
    <div class="clearfix formOuterPost tal">
      <%= p.file_field :image, class: "profile profile_picture", style: "visibility: hidden; width: 1px; height: 1px" ,:onchange => "showimagepreview(this)" %>
      <!-- <input id="Photo" name="Photo" style="visibility: hidden; width: 1px; height: 1px" multiple="" type="file"> -->

      <div class="uploadPhoto" onclick="$('.profile_picture').click();" style="background-image: url(<%=p.object.try(:image).try(:url)%>);">
        <div class="reletive">
          <img src="/assets/images/camera.png" alt="" id='imgprvw'>          
          <div>Change Photo</div>
        </div>
      </div>
      <div class="error img_error"></div>
      <div class="col-sm-6 pr10">
        <label>First Name</label>
        <%= f.text_field :first_name, class: "profile inputTextW small", placeholder: "First Name" %>
      </div>
      <div class="col-sm-6 pl10">
        <label>Last Name</label>
        <%= f.text_field :last_name, class: "profile inputTextW small", placeholder: "Last Name" %>
      </div>
      <div class="col-sm-12">
        <div class="blackHD">Address</div>
      </div>
      <div class="col-sm-6 pr10">
        <label>Country</label>
        <div class="selctFormBox">      
          <%= p.text_field "country", value: select_type(p, "country"), class: "profile selectInput" %>
          <%= p.select(:country, country_list, {:include_blank => "Select"}, class: "select")  %>
        </div>
<!--         <div id="country_error"></div>
 -->      </div>

      <div class="col-sm-6 pl10">
        <label class="">City</label>
        <%= p.text_field :city, class: "profile inputTextW small", placeholder: "City" %>
      </div>
      <div class="clearfix"></div>
      <div class="col-sm-6 pr10">
        <label>State</label>
        <%= p.text_field :state, class: "profile inputTextW small", placeholder: "Street" %>
      </div>
      <div class="col-sm-6 pl10">
        <label>Zipcode</label>
        <%= p.number_field :post_code, class: "profile inputTextW small", placeholder: "10001" %>
      </div>
      <div class="clearfix"></div>
      <div class="col-sm-6 pr10">
        <label>Address1</label>
        <%= p.text_field :address1, class: "profile inputTextW small", placeholder: "Street" %>
      </div>
      <div class="col-sm-6 pr10">
        <label>Address2</label>
        <%= p.text_field :address2, class: "profile inputTextW small", placeholder: "Street" %>
      </div>
      <div class="clearfix"></div>
      <div class="col-sm-6 pr10">
        <label>Gender</label>
        <div class="selctFormBox">      
          <%= p.text_field "gender", value: select_type(p, "gender"), class: "profile selectInput" %>
          <%= p.select(:gender, [['Male','male'],['Female','female']], {:include_blank => "Select"}, class: "select")  %>
        </div>
        <div id="gender_error"></div>
      </div>
      <div class="col-sm-6 pl10">
        <label>Phone</label>
        <%= p.number_field :phone_no, class: "profile inputTextW small", placeholder: "0123456789" %>
      </div>
      <div class="clearfix"></div>
      <div class="col-sm-6 pr10">
        <label>Select Type</label>
        <div class="selctFormBox">
          <%= p.text_field "profile_type", value: select_type(p, "profile_type"), class: "profile selectInput" %>
          <%= p.select(:profile_type, [['Individual','individual'],['Company','company'],['Other','other']], {:include_blank => "Select"}, class: "select")  %>
        </div>
        <div id="profile_type_error"></div>
      </div>
      <div class="col-sm-6 pl10">
        <label>Date of Birth</label>
          <%= p.text_field :dob, class: "profile inputTextW small date fullWdth dob" %> 
        <!-- <input type="text" placeholder="987654321" class=""> -->
      </div>
      <div class="clearfix"></div>
      <div class="col-sm-6 pr10">
        <label>Screen Name</label>
        <%= f.text_field :screen_name, class: "inputTextW small", placeholder: "Screen Name" %>
        <!-- <input type="text" placeholder="john2015" class="inputTextW small  ">  -->
      </div>
      <div class="col-sm-6 pl10">
        <label>Location</label>
        <%= p.text_field :location, class: "inputTextW small", placeholder: "Location" %>
       <!--  <input type="text" placeholder="South America" class="inputTextW small  "> -->
      </div>      
      <div class="col-sm-12">
        <input type="submit" value="Save " class="profile_submit blueBtn">        
        <%= link_to "Cancel", "/dashboard",class: 'grayBtn' %>
      </div>
    </div>
  <%end%>
<%end%>  


<script>
 // function showimagepreview(input) {
 //    if (input.files && input.files[0]) {
 //    var filerdr = new FileReader();
 //    filerdr.onload = function(e) {

 //    // $('#imgprvw').attr('src', e.target.result);
 //    $(".uploadPhoto").css('background-image', 'url(' + e.target.result + ')');
 //    }
 //    filerdr.readAsDataURL(input.files[0]);
 //    }
 //  }

  $("form.profile_form").validate({
    errorPlacement: function(error, element) {
      if(element.attr("name") == "user[profile_attributes][gender]") {
        error.appendTo($("#gender_error"));
      } else if(element.attr("name") == "user[profile_attributes][profile_type]") {
        error.appendTo($("#profile_type_error"));
      } else {
        error.insertAfter(element);
      }
    },
    rules: {
        "user[first_name]": { required: true },
        "user[last_name]": { required: true },
        // "user[profile_attributes][country]": { required: true , minlength: 2, maxlength: 80},
        "user[profile_attributes][city]": { required: true, minlength: 2, maxlength: 80},
        "user[profile_attributes][street]": { required: true, minlength: 2, maxlength: 80 },
        "user[profile_attributes][post_code]": { required: true },
        "user[profile_attributes][gender]": { required: true },
        "user[profile_attributes][phone_no]": { required: true },
        "user[profile_attributes][profile_type]": { required: true },
        "user[profile_attributes][dob]": { required: true },
        "user[screen_name]": { required: true , minlength: 4, maxlength: 80},
        "user[profile_attributes][location]": { required: true, minlength: 3, maxlength: 80 }
      },
      messages: {
        "user[profile_attributes][post_code]": "Please enter valid numbers",
        "user[profile_attributes][phone_no]": "Please enter valid numbers",
      },
     submitHandler: function(form) {
       $('form.profile_form').submit();
     }
  });
  $('.dob').datetimepicker( {format: 'YYYY-MM-DD', maxDate: moment()});
</script>